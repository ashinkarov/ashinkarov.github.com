
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Firefox on Gentoo - ashinkarov.github.com</title>
  <meta name="author" content="Artem Shinkarov">

  
  <meta name="description" content="Before I&#8217;ll start describing my adventure with firefox on gentoo, I&#8217;ll clarify
that firefox is the only browser that I am using on my &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://ashinkarov.github.com/blog/2013/04/09/firefox-in-gentoo/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="ashinkarov.github.com" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">ashinkarov.github.com</a></h1>
  
    <h2>thoughts and observations</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:ashinkarov.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/"><i class="icon-thumbs-up"></i> Welcome</a></li>
  <li><a href="/publications"><i class="icon-cogs"></i> Publications</a></li>
  <li><a href="/teaching"><i class="icon-group"></i> Teaching</a></li>

  <li><a href="/blog"><i class="icon-file-alt"></i> Blog</a></li>

  <!--li><a href="/blog/archives">Archives</a></li-->
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Firefox on Gentoo</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-04-09T01:56:00+01:00" pubdate data-updated="true">Apr 9<span>th</span>, 2013</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>Before I&#8217;ll start describing my adventure with firefox on gentoo, I&#8217;ll clarify
that firefox  is the only browser that I am using on my computers (well
links/elinks/w3m for text browsing) and hopefully nothing is going to change my
mind.  Why so?</p>

<p>For the past couple of years I have tried a bunch of alternatives and still believe
that firefox is the best choice.  When chrome(ium) became popular, a lot of people
switched to the glorious product of google, and it seems to me that the only
reason for that switch was a very good job of google&#8217;s marketing department.
I found it quite cheeky when they started the overall development, as firefox was
really the best on the market at that time, it was free, and it was way more popular
than anything else, that was probably something that google couldn&#8217;t tolerate.
I always ask myself, wouldn&#8217;t it be more productive, to join
the forces and to work on one product?  But then I kind of realise that if it
would happen we would really end up with monopoly in the world of browsers,
which we don&#8217;t want.</p>

<!-- more-->


<p>So, my main dissatisfaction with chromium and any webkit-based browser is that
they cannot fix freaking selection.  I can&#8217;t show the picture, as I don&#8217;t have
it installed, but whenever you select a text on a page with a complex layout,
selection goes faaaar beyond the text and selects some random areas of the
web-page.  You guys might say that I am picky, but this selection thing really
drives me nuts.  Can anyone fix it?</p>

<p>Another thing that nobody can mimic is
<a href="http://www.vimperator.org/vimperator">Vimperator</a>.  Yeah, there are some
plugins in chrome, but they are just funny.  Vimperator is not about adding
h,j,k shortcuts, seriously.  Look at the code if you don&#8217;t believe me.</p>

<p>Finally, to my impression firefox is the best balance between speed and
resources.  Probably chrome can do regexps faster, but on my system it eats
noticeably more memory which  means that if you have more that one tab
open then most of the regexp effort goes down the drain because of memory
overheads.  It is not really a scientific fact &#8211; just my personal intuition.
May be you can configure this stuff, but after I used all my patience,
firefox is still the winner.</p>

<h2>Running browsers on gentoo</h2>

<p>Any browser is a critical application, which should work fast and shouldn&#8217;t fail.
That is why I am and will compile all my browsers from source with the highest
possible optimisations.  After one of recompilations I found out that sometimes
the fonts were rendered bold in the places where they shouldn&#8217;t be.  Mainly it
happened when you scroll up and down with a wheel of your mouse.  See the picture
below.</p>

<p><img src="/images/firefox-gentoo.png"></p>

<p>A couple of phrases in the middle of the wikipedia page look like if they are
bold.  In the beginning I though that it is a problem of fontconfig and
infinality which I was actively configuring at that time.  Later I found out
that it was a problem in firefox itself.  The thing happens not very often and if
you select and deselect this bold text, the boldness goes away.  So in principle
you could even live with this thing, it is just quite annoying.</p>

<p>After some googling I found a
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=775203">bug</a>
in the firefox bugzilla marked as <em>fixed</em>.
Well, it definitely wasn&#8217;t fixed on my system, and I am using
the latest releases.  Then I started to read the patches and
investigate what the hell is going on.  It turned out, that the problem had
something to do with the bug in cairo, and firefox people have their own
version of cairo, where they happily committed the fix.  So far so good, but
gentoo is linking against system cairo which does <em>not</em> have these changes.</p>

<blockquote><p>Anyone knows why?</p></blockquote>

<p>Anyhow, after some more investigation I found a flag which links against cairo
from the firefox repository.  The flag is called <code>--disable-system-cairo</code> :)
So all you need to do is to add the following line to the e-build:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>    mozconfig_annotate '' --disable-system-cairo</span></code></pre></td></tr></table></div></figure>


<p>recompile, and the problem happily goes away.  May be one day I will put
an overlays for that.  May be one day gentoo people will add this thing into
default tree.  Gentoo people, where are you? :)</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Artem Shinkarov</span></span>

      








  


<time datetime="2013-04-09T01:56:00+01:00" pubdate data-updated="true">Apr 9<span>th</span>, 2013</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/cairo/'>cairo</a>, <a class='category' href='/blog/categories/firefox/'>firefox</a>, <a class='category' href='/blog/categories/gentoo/'>gentoo</a>, <a class='category' href='/blog/categories/linux/'>linux</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://ashinkarov.github.com/blog/2013/04/09/firefox-in-gentoo/" data-via="" data-counturl="http://ashinkarov.github.com/blog/2013/04/09/firefox-in-gentoo/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/04/08/updating-my-blog/" title="Previous Post: Updating my blog">&laquo; Updating my blog</a>
      
      
        <a class="basic-alignment right" href="/blog/2016/03/23/british-scientists-1/" title="Next Post: Чем занимаются британские ученые (1)">Чем занимаются британские ученые (1) &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1 style="padding-bottom: 15px;">About Me</h1>
  <table>
    <tr class="spaceunder">
        <td colspan="2" style="text-align:right;">
        <img src="/images/me.jpg" width="200" height="300" /></td>
    </tr>
    <tr class="spaceunder">
        <td width="10%"><i class="icon-user"></i></td>
        <td><b>Artem Shinkarov</b></td>
    </tr>
    <tr class="spaceunder">
        <td><i class="icon-envelope-alt"></i></td>
        <td><a href="mailto:artyom.shinkaroff@gmail.com">artyom.shinkaroff@gmail.com</a></td>
    </tr>
    <tr>
        <td style="vertical-align: text-top"><i class="icon-building"></i></td>
        <td><p>G.26, Earl Mountbatten Building<br/>
               Heriot-Watt University<br/>
               Riccarton, Edinburgh<br/>
               EH14 4AS, United Kingdom</p>
        </td>
    </tr>
  </table>
</section>

<section>
  <h1><i class="icon-github icon-large"></i> GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/ashinkarov">@ashinkarov</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'ashinkarov',
            count: 8,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Artem Shinkarov -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'ashinkarov-github-com';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://ashinkarov.github.com/blog/2013/04/09/firefox-in-gentoo/';
        var disqus_url = 'http://ashinkarov.github.com/blog/2013/04/09/firefox-in-gentoo/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
